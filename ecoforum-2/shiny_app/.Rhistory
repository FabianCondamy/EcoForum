ggplot(data.frame(block_maxima), aes(x = block_maxima)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 10,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgev(x,
loc = fit_weibull$estimate["loc"],
scale = fit_weibull$estimate["scale"],
shape = fit_weibull$estimate["shape"]),
size = 1.2) +
coord_cartesian(xlim = c(0, 1.2)) +
scale_fill_manual("", values = c("Simulations" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode des maximas en bloc pour une loi uniforme",
x = "Maxima par bloc",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Graphe
ggplot(data.frame(block_maxima), aes(x = block_maxima)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 10,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgev(x,
loc = fit_weibull$estimate["loc"],
scale = fit_weibull$estimate["scale"],
shape = fit_weibull$estimate["shape"]),
size = 1.2) +
coord_cartesian(xlim = c(0, 1.2)) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode des maximas en bloc pour une loi uniforme",
x = "Maxima par bloc",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Graphe
ggplot(data.frame(block_maxima), aes(x = block_maxima)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 10,
color = "black") +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgev(x,
loc = fit_weibull$estimate["loc"],
scale = fit_weibull$estimate["scale"],
shape = fit_weibull$estimate["shape"]),
size = 1.2) +
coord_cartesian(xlim = c(0, 1.2)) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode des maximas en bloc pour une loi uniforme",
x = "Maxima par bloc",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
x <- runif(n, min = 0, max = 10)
# Taille des blocs
taille_blocs <- 50
nb_blocs <- floor(n / taille_blocs)
# Maxima par bloc
block_maxima <- sapply(1:nb_blocs, function(i) {
start <- (i - 1) * taille_blocs + 1
end <- i * taille_blocs
max(x[start:end])
})
# Ajustement d'une loi de Weibull (shape < 0)
fit_weibull <- fgev(block_maxima)
# Affichage des paramètres (pour voir le shape négatif)
print(fit_weibull)
# Graphe
ggplot(data.frame(block_maxima), aes(x = block_maxima)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 10,
color = "black") +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgev(x,
loc = fit_weibull$estimate["loc"],
scale = fit_weibull$estimate["scale"],
shape = fit_weibull$estimate["shape"]),
size = 1.2) +
coord_cartesian(xlim = c(0, 1.2)) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode des maximas en bloc pour une loi uniforme",
x = "Maxima par bloc",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Graphe
ggplot(data.frame(block_maxima), aes(x = block_maxima)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 10,
color = "black") +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgev(x,
loc = fit_weibull$estimate["loc"],
scale = fit_weibull$estimate["scale"],
shape = fit_weibull$estimate["shape"]),
size = 1.2) +
coord_cartesian(xlim = c(0, 1.2)) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode des maximas en bloc pour une loi uniforme",
x = "Maxima par bloc",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Graphe
ggplot(data.frame(block_maxima), aes(x = block_maxima)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 10,
color = "black") +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgev(x,
loc = fit_weibull$estimate["loc"],
scale = fit_weibull$estimate["scale"],
shape = fit_weibull$estimate["shape"]),
size = 1.2) +
coord_cartesian(xlim = c(0, 15)) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode des maximas en bloc pour une loi uniforme",
x = "Maxima par bloc",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Simulation
set.seed(123)
n <- 10000
x <- rnorm(n)
# Choix du seuil : 95e percentile
u <- quantile(x, 0.95)
# Sélection des excès au-dessus du seuil
excesses <- x[x > u] - u  # on centre les données sur le seuil
# Ajustement de la loi de Pareto généralisée (GPD)
fit_gpd <- fpot(x, threshold = u, model = "gpd")
# Affichage des paramètres estimés
print(fit_gpd)
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(excesses), aes(x = excesses)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 30,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
library(evd)
library(ggplot2)
# Simulation
set.seed(123)
n <- 10000
x <- rnorm(n)
# Choix du seuil : 95e percentile
u <- quantile(x, 0.95)
# Sélection des excès au-dessus du seuil
excesses <- x[x > u] - u  # on centre les données sur le seuil
# Ajustement de la loi de Pareto généralisée (GPD)
fit_gpd <- fpot(x, threshold = u, model = "gpd")
# Affichage des paramètres estimés
print(fit_gpd)
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(excesses), aes(x = excesses)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 30,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
?fpot
# Simulation
set.seed(123)
n <- 10000
x <- rnorm(n)
# Choix du seuil : 95e percentile
u <- quantile(x, 0.95)
# Sélection des excès au-dessus du seuil
exces <- x[x > u] - u  # on centre les données sur le seuil
# Ajustement de la loi de Pareto généralisée (GPD)
fit_gpd <- fpot(x, threshold = u, model = "gpd")
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(exces), aes(x = exces)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 30,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(exces), aes(x = exces)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 35,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(exces), aes(x = exces)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 25,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
library(evd)
library(ggplot2)
# Simulation
set.seed(123)
n <- 10000
x <- rcauchy(10000, location = 0, scale = 1)
u <- quantile(x, 0.95)
# Sélection des excès au-dessus du seuil
exces <- x[x > u] - u  # on centre les données sur le seuil
# Ajustement de la loi de Pareto généralisée (GPD)
fit_gpd <- fpot(x, threshold = u, model = "gpd")
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(exces), aes(x = exces)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 25,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(exces), aes(x = exces)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 100,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(exces), aes(x = exces)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 100,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) + xlim(c(-10,500))
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(exces), aes(x = exces)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 100,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) + xlim(c(-10,500)) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(exces), aes(x = exces)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 150,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) + xlim(c(-10,500)) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(exces), aes(x = exces)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 150,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) + xlim(c(-10,400)) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
library(evd)
library(ggplot2)
# Simulation
set.seed(123)
n <- 10000
x <- runif(10000, min = 0, max = 1)
u <- quantile(x, 0.95)
# Sélection des excès au-dessus du seuil
exces <- x[x > u] - u  # on centre les données sur le seuil
# Ajustement de la loi de Pareto généralisée (GPD)
fit_gpd <- fpot(x, threshold = u, model = "gpd")
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(exces), aes(x = exces)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 150,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) + xlim(c(-10,400)) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
x <- runif(10000, min = 0, max = 100)
u <- quantile(x, 0.95)
# Sélection des excès au-dessus du seuil
exces <- x[x > u] - u  # on centre les données sur le seuil
# Ajustement de la loi de Pareto généralisée (GPD)
fit_gpd <- fpot(x, threshold = u, model = "gpd")
# Graphe : histogramme des excès + densité GPD
ggplot(data.frame(exces), aes(x = exces)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"), bins = 150,
color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,  # car les excès sont centrés
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) + xlim(c(-10,400)) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) pour une loi normale",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Packages nécessaires
library(evd)
library(ggplot2)
# Génération de données : loi uniforme sur [0, 1]
set.seed(123)
n <- 10000
x <- runif(n, min = 0, max = 1)
# Choix du seuil élevé (par exemple 95e percentile)
u <- quantile(x, 0.95)
# Excès au-dessus du seuil
excesses <- x[x > u] - u
# Ajustement GPD sur les excès
fit_gpd <- fpot(x, threshold = u, model = "gpd")
# Affichage des paramètres estimés
print(fit_gpd)
# Visualisation : histogramme des excès + densité théorique GPD
ggplot(data.frame(excesses), aes(x = excesses)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"),
bins = 30, color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) - Loi uniforme",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
x <- runif(n, min = 0, max = 100)
# Choix du seuil élevé (par exemple 95e percentile)
u <- quantile(x, 0.95)
# Excès au-dessus du seuil
excesses <- x[x > u] - u
# Ajustement GPD sur les excès
fit_gpd <- fpot(x, threshold = u, model = "gpd")
# Visualisation : histogramme des excès + densité théorique GPD
ggplot(data.frame(excesses), aes(x = excesses)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"),
bins = 30, color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) - Loi uniforme",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Génération de données : loi uniforme sur [0, 1]
n <- 10000
x <- runif(n, min = 0, max = 100)
# Choix du seuil élevé (par exemple 95e percentile)
u <- quantile(x, 0.95)
# Excès au-dessus du seuil
excesses <- x[x > u] - u
# Ajustement GPD sur les excès
fit_gpd <- fpot(x, threshold = u, model = "gpd")
# Visualisation : histogramme des excès + densité théorique GPD
ggplot(data.frame(excesses), aes(x = excesses)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"),
bins = 30, color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) - Loi uniforme",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
# Visualisation : histogramme des excès + densité théorique GPD
ggplot(data.frame(excesses), aes(x = excesses)) +
geom_histogram(aes(y = ..density.., fill = "Simulation"),
bins = 40, color = "black", alpha = 0.6) +
stat_function(aes(color = "Densité théorique"),
fun = function(x) dgpd(x,
loc = 0,
scale = fit_gpd$estimate["scale"],
shape = fit_gpd$estimate["shape"]),
size = 1.2) +
scale_fill_manual("", values = c("Simulation" = "skyblue")) +
scale_color_manual("", values = c("Densité théorique" = "red")) +
labs(title = "Méthode du dépassement de seuil (POT) - Loi uniforme",
x = "Excès au-dessus du seuil",
y = "Densité") +
theme_minimal() +
theme(legend.position = "top")
library(readr)
library(sf)
install.packages("sf")
setwd("C:/Users/Fabian/EcoForum/ecoforum-2/shiny_app")
setwd("C:/Users/Fabian/EcoForum/ecoforum-2/shiny_app")
shiny::runApp()
runApp()
library(shiny)
runApp()
runApp()
runApp()
remove.packages("maptiles")
install.packages("maptiles", dependencies = TRUE)
